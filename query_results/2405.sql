SELECT * FROM (title_basics tb JOIN title_ratings tr ON tr.primaryTitle = tb.title) LEFT OUTER JOIN (name_basics nb JOIN title_crew tc ON nb.primaryName=tc.director) RIGHT OUTER JOIN (title_principals tp ON tp.ordering < 10 AND tp.category='Actress') WHERE (tb.isAdult > 'No' OR NOT EXISTS(SELECT * FROM title_basics where isAdult='Yes')) GROUP BY nb.primaryName ORDER by avg_rating DESC LIMIT 5