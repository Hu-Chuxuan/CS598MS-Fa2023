SELECT * FROM TITLE_PRINCIPALS WHERE JOB = "character" AND CATEGORY IN ('lead') ORDER BY RANK() OVER(PARTITION BY CHARACTERID ROWS BETWEEN UNBOUNDED PRECEDING AND FOLLOWING)