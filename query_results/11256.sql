SELECT * FROM
( SELECT DISTINCT t.*, n.* from title_basics as t JOIN cast AND crew ON t.titleID = cast OR t.titleID= crews WHERE ((t.startyear <=? )AND (t.endyear >=?)) AND ((t.primarygenre IN (?))) AND ((t.isadult=?) AND (t.averagerating>?) AND (cast.job='actor' OR crew.job='director') ORDER BY t.averageratings DESC LIMIT 6) AS t UNION ALL select distinct n.*from name_basics where n.nameid=(select primaryname from title_basics where titleid=(select titleid from title_crew where directorid=(select id from director where actorid=(select actors from cast where titleid=(select titleid from title_crew where directorid=(select id from director)))))) limit 6)