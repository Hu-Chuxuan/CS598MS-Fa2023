SELECT DISTINCT
    TITLEID AS IDENTIFIER,
	TITLENAMEASSED BYUSER AS MOVIENAME,
	AVERAGERATING AS RATE,
	NUMOFRECOMMENDATIONS AS RECOMMENDATIONCOUNT
FROM
    IMDB.MOVIES
WHERE
    STARTYEAR <= USERINPUTDATE AND ENDYEAR >= USERINPUTDATE
AND
    ISADULT = 0 OR ISADULT IN ('1') -- '1' means ADULT content
ORDERBY
    AVERAGERECOMMANDATION DESC LIMIT 5 OFFSET 0