SELECT * FROM ( SELECT tb.*, tr.*, nb.*, c.*, p.* FROM title_basic as tb INNER JOIN title_rating AS tr ON tb.titleID = tr.titleID INNER JOIN name_basic AS nb ON tb.titleID = nb.titleID INNER JOIN title_crew AS tc ON tb.titleID = tc.movieID INNER JOIN title_principal AS pc ON tb.titleID = pc.movieID ) WHERE NOT EXISTS(SELECT * FROM title_rating AS rr INNER JOIN user_preferences UP ON rr.titleID=UP.MovieID AND UP.userID='$USER') GROUP BY tb.titleID ORDER BY SUM(tr.averageRating)/COUNT(*) DESC LIMIT $LIMIT