SELECT * FROM movies WHERE rating > 7 AND genre = "comedy" OR (rating >= 8 AND genre!= "action") ORDER BY rating DESC LIMIT 5