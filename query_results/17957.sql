SELECT t.* FROM ((((title_basics JOIN title_ratings ON title_basics.tconst = title_ratings.tconst AND title_basics.startYear <=? ORDER BY title_ratings.numVotes DESC LIMIT? OFFSET?)) JOIN (title_principals JOIN title_basics ON title_principals.tconst=title_basics.tconst AND title_principals.ordering IN (?)) ON title_rating.tconst=title_principles.tconst AND title_principals.category='director') JOIN name_basics ON name_basics.nconst=title_principle.nconst WHERE title_ratting.averageRating >= 6 AND title_principal.job LIKE '%director%' AND title_principal.job NOT LIKE '%assistant%')) AS t GROUP BY t.tconst ORDER BY title_ratings.numvotes desc LIMIT 3 offset 0