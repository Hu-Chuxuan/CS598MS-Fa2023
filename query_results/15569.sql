SELECT * FROM ( SELECT 1 AS id, tconst, titleType, primaryTitle, originalTitle, isAdult, startYear, endYear, runtimeMinutes, genres, directors, writers, nconst, category, job, characters, avg(rating), count(*) from title_ratings GROUP BY tconst, titleType, primaryTitle, originalTitle, isAdult, startYear, endYear, runtimeMinutes, genres, directors, writers, nconst, category, job, characters HAVING COUNT(*) > 0 ) WHERE avg(rating)>=4 AND ((startyear>=1990 OR startyear<=1999)) AND ((endyear>='2000')AND((endyear<>'2000')))