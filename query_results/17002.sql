SELECT * from ((SELECT rating_average,count(*) as countfrom movieratings where (genre = "western") group by genre having count > 1 order by rating_average desc limit 1 ) union SELECT rating_average,(rating_avg+1)/2 as new_rating,rating_voterid,rating_time,rating_text,rating_type,rating_url from rating_details where rating_genre like "%Western%"and rating_date >= now()-interval 1 hour group by rating_genre,rating_date,rating_time,rating_userid having count > 1 order by rating_time asc limit 1)) as r_all join ((SELECT rating_average,count(*) as countfrom movieratings where (genre = "western") group by genre having count > 1 order by rating_average desc limit 1 )union SELECT rating_average,(rating_avg+1)/2 as new_rating,rating_voterid,rating_time,rating_text,rating_type,rating_url from rating_details where rating_genre like "%Western%"and rating_date >= now()-interval 1 hour group by rating_genre,rating_date,rating_time,rating_userid having count > 1 order by rating_time asc limit 1))as r_all on r_all.new_rating=r_all.rating_avg