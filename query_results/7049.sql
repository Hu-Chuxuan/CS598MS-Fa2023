SELECT * FROM
( SELECT t.*, r.rating AS rating, uh.movieID as userHistoryMovieID FROM title_ratings t INNER JOIN title_basics b ON t.title_id = b.tconst UNION ALL SELECT t.*, r.rating AS rating, uh.movieID as userHistoryMovieID FROM title_ratings t INNER JOIN name_basics nb ON t.title_id = nb.nconst INNER JOIN title_crew c ON nb.primaryName=c.director UNION ALL SELECT t.*, r.rating AS rating, uh.movieID as userHistoryMovieID FROM title_ratings t INNER JOIN name_basics nb ON t.title_id = nb.nconst INNER JOIN title_principals p ON nb.primaryName=p.character UNION ALL SELECT t.*, r.rating AS rating, uh.movieID as userHistoryMovieID FROM title_ratings t INNER JOIN name_basics nb ON t.title_id = nb.nconst WHERE nb.primaryName LIKE '%Dwayne Johnson%' AND r.averageRating >= 7 ORDER BY rating DESC LIMIT 10