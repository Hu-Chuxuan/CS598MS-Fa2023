SELECT * FROM ( SELECT DISTINCT t.*, r.averageRating AS rating, COUNT(r.numVotes) AS votesCount WHERE r.title_id = t.movieId AND r.userID = 'USER_NAME' GROUP BY t.movieId ) AS t INNER JOIN ( SELECT * FROM ( SELECT DISTINCT n.*, COUNT(*) AS numUsers WHERE n.name_id IN ('N0000', 'N9998') GROUP BY name_id ) AS n ON n.category = 'ACTOR/ACTRESS' GROUP BY actorName ) AS actors ON t.movieId = actors.actorName UNION ALL SELECT * FROM ( SELECT DISTINCT c.*, SUM(c.jobs) AS totalJobs FROM ( SELECT CONCAT(' ', p.primaryName,'') AS characterName, j.*, COUNT(*)/SUM(j.jobs) AS jobsFromMovie FROM ( SELECT * FROM ( SELECT DISTINCT c.*, COUNT(*) AS numCharacters FROM ( SELECT * FROM ( SELECT DISTINCT np.*, COUNT(*) AS numPeople FROM ( SELECT * FROM name_basics WHERE category LIKE '%%') AS np WHERE np.birthYear > 1967 GROUP BY personName ) AS people WHERE n.name_id NOT IN ('N9998','N0000')) AS c LEFT OUTER JOIN ( SELECT * FROM ( SELECT DISTINCT j.*, COUNT(*) AS numJobs FROM crew_details AS d WHERE d.position LIKE 'Director%' OR d.position LIKE 'Writer%' GROUP BY position ) AS j WHERE j.jobs >= 2 ) AS movies USING (characterName)) GROUP BY characterName ORDER BY totalJobs DESC LIMIT 10 OFFSET 0 ) AS c GROUP BY characterName ) ) AS cast ON t.movieId = cast.characterName