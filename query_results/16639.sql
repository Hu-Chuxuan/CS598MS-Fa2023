SELECT * FROM (title_ratings INNER JOIN (title_basic INNER JOIN (name_basic INNER JOIN (title_crew INNER JOIN (title_principal INNER JOIN (title_basic))))) ON ((title_rating.averageRating > 6 AND (title_basic.primaryTitle LIKE 'comedy' OR title_basic.isAdult = false)) AND (title_basic.startYear >= 2007 AND title_basic.endYear <= 2019) AND (title_basic.runtimeMinutes < 2hrs) AND (title_basic.genre IN ('Comedy', 'Drama')) AND (title_prinicpal.category IS NOT NULL)) WHERE userPreferedMovies <> '') AS A(movie_id, movie_averageRatings), (title_basic INNER JOIN (name_basic INNER JOIN (title_crew INNER JOIN (title_princical INNER JOIN (title_basic)))) ON ((title_basic.primaryTitle LIKE 'comedy' OR title_basic.isAdult = FALSE) AND (title_basic.startYear BETWEEN 2007 AND 2019) AND (title_basic.endYear <= 2019) AND (title_basic.runtimeMinutes < 2HR) AND (title_basic.genre IN ('Comedy', 'Drama') AND title_princepal.category IS NOT NULL))) AS C