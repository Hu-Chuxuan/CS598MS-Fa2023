SELECT * FROM ( SELECT DISTINCT t.*, c.*, r.*, p.* WHERE  (t.title_type = "movie" AND t.startyear >= 2000 ) OR (c.category="actor")OR(r.job= "writer")) AS t JOIN actors as a ON (a.primaryname LIKE "%Ted%" OR a.birthyear BETWEEN 1987 AND 1989))AS a LEFT OUTER JOIN casts as b ON (a.id = b.castmember_id)LEFT OUTER JOIN crews as c ON (b.directorID = c.id)LEFT OUTER JOIN ratings as d ON (d.averagerating > 7)AND (d.numvotes>0)LEFT OUTER JOIN titles as e ON (e.genre IN ("comedy", "romantic comedy","adventure")AND(e.isadult IS NULL))