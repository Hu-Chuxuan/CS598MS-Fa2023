SELECT * FROM
( SELECT DISTINCT tc.*, nr.*, np.*, c.*, r.rating AS rating FROM movies as m INNER JOIN title_basicstitle_ratings ON m.title_id = title_ratings.movie_id INNER JOIN title_name_basictitle_crew ON title_basicstitle_ratings.title_id = title_name_basictitle_crew.title_id INNER JOIN title_principalstitle_principals ON title_name_basictitle_crew.name_id= title_principalstitle_principals.name_id LEFT OUTER JOIN ratings AS r ON m.title_id = r.title_id WHERE title_type='tv' AND genre IN ('action','comedy') ) as tc INNER JOIN title_ratingsnr ON tc.title_id=title_ratingsnr.title_id INNER JOIN title_name_basictitle_crewnp ON title_ratingsnr.title_id=title_name_basictitle_crewnp.title_id INNER JOIN title_principalstitle_principalsc ON title_name_basictitle_crewnp.name_id=title_principalstitle_principalsc.name_id LEFT OUTER JOIN titles AS rr ON tc.title_id=rr.title_id AND rr.category!= "Documentary" AND rr.job!="Actor/Actress")
as tc INNER JOIN title_principalstitle_principalsc ON tc.title_id=title_principalstitle_principalsc.title_id LEFT OUTER JOIN actors AS ar ON title_principalstitle_principalsc.actor_id=ar.actor_id WHERE ar.actor_id IS NULL GROUP BY tc.title_id ORDER BY rating DESC LIMIT 5