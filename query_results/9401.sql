SELECT * FROM ( SELECT TOP 25 PERCENT tconst, avgrat AS rating FROM Title_Ratings WHERE tconst = @Moviename ORDER BY avgrat DESC ) AS RATINGS INNER JOIN ( SELECT DISTINCT tconst, avgrat AS rating FROM Title_Ratings GROUP BY tconst HAVING COUNT(*) > 1 AND SUM(avgrat) < 3 ) AS MOST_POPULAR ON RATINGS.tconst = MOST_POPULAR.tconst WHERE MOST_POPULAR.rating <= RATINGS.rating GROUP BY tconst