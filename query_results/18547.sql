SELECT * FROM ( SELECT DISTINCT tconst AS titleid, avgrat AS score, numvots AS totalvotecount
FROM title_ratings WHERE titletype ='movie') AS rt JOIN (SELECT distinct tconst from title_basic where titletype='movie' order by avgrat desc limit 20 offset 0 ) as b ON rt.tconst=b.tconst ORDER BY rt.avgrat DESC LIMIT 10 OFFSET 0