SELECT * FROM ( SELECT DISTINCT titleId, titleType AS genre, castFrom, castTo, castOrdering, castCategory, castJob, castCharacters, 
    AVG(rating), COUNT(*) AS voteCount FROM title_ratings WHERE titleId IN ('tt0000001','tt0000002') AND (castFrom BETWEEN '1894'::date AND CAST('2009-07-18'::DATE)) ) AS data1 JOIN ( SELECT distinct titleId, titleType AS genre,directors,writers FROM title_crew WHERE titleId = 'tt0000001') AS data2 ON data1.titleId=data2.titleId AND data1.castDirectors=data2.directors AND data1.castWriters=data2.writers JOIN ( SELECT distinct titleId, titleType AS genre,primaryTitle,originalTitle,isAdult,startYear,endYear,runtimeMinutes,genre FROM title_basics WHERE titleId='tt0000001') AS data3 ON data1.titleId=data3.titleId AND data1.castGenres=data3.genre GROUP BY data3.titleId ORDER BY data3.startYear ASC LIMIT 2 OFFSET 0) AS finalData WHERE (finalData.titleId!= '') AND (finalData.voteCount >= 1 OR ((finalData.castFrom <= '2009-07-18'::Date AND finalData.castTo > '2009-07-18'::Date))) 