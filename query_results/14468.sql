SELECT * FROM `title` WHERE `genre` LIKE '%comedy%' AND (`startyear <=? OR `endyear >=?)` ORDER BY `avgrating` DESC LIMIT 1 OFFSET 0