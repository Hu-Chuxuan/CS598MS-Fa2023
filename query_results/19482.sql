SELECT * FROM (title_basic INNER JOIN (title_rating INNER JOIN (name_basic INNER JOIN (title_crew INNER JOIN (title_principal INNER JOIN (user_input INNER JOIN user_preferences))) ON ((title_prinicpal.category = user_input.category OR title_princapal.job = user_input.job)) AND (user_input.character = title_princepal.characters)))) ON ((title_basics.genre = title_rating.averageRating)) WHERE (title_basics.startyear <= 2006) ORDER BY rating DESC LIMIT 10