SELECT DISTINCT t.* FROM ((title_ratings r JOIN title_crew c ON r.id = c.id AND r.primaryTitle = c.id) JOIN title_principals p ON r.id = p.id AND r.job IN ('director','writer') )JOIN ((((name_basics s JOIN title_rating r ON r.numVotes > 6 ORDER BY avgRating DESC LIMIT 1)) UNION ALL (s.birthYear BETWEEN 1970 AND 1990 OR s.deathYear < 1970)))AS d WHERE d.d.id IS NOT NULL AND s.d.category LIKE '%Marvel%' AND EXISTS(SELECT * FROM ((title_ratings r JOIN title_crew c ON r.id = c.id AND r.primaryTitle = c.id) JOIN title_principals p ON r.id = p.id AND r.job IN ('director','writer'))WHERE r.id=c.id AND c.id = p.id AND p.job='actor'AND p.ordering>=(CASE WHEN s.birthYear >= 1970 THEN 0 ELSE IF s.birthYear <= 1970 THEN 1 END)) AND (r.averageRating>=3 OR r.averageRating<=1) AND (s.birthYear between 1970 and 1990)