SELECT title_recommendation.* FROM (title_basic JOIN title_rating WHERE title_basic.title_id = title_rating.movie_id AND user_input LIKE '%' +? + '%') JOIN (name_basic JOIN title_crew) ON ((title_basic.title_id= title_crew.movie_id) OR (title_crew.director_id = name_basic.primary_name)) JOIN (name_basic JOIN title_principal) ON ((title_crew.writer_id = title_principal.job) OR (title_principal.character = 'Director')) JOIN (title_ratting JOIN title_crew) ON (title_rating.average_rating >=?)