SELECT * FROM ( SELECT title_id AS TITLEID, title_type AS TYPE, title_basics.*, cast(genre AS VARCHAR(2)) AS GENRES, title_crew.*, title_principal.* WHERE title_type='movie') AS RECOMMENDATIONS INNER JOIN title_rating ON title_rating.title_id = recommandation.title_id AND recommandation.title_type=title_rating.title_type GROUP BY title_rating.title_id HAVING COUNT(*)>0 ORDER BY AVERAGE(average_rating), COUNT(*) DESC LIMIT 5