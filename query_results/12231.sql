SELECT * FROM ((SELECT DISTINCT TITLE_CREW.*,(SELECT COUNT(*) AS NUM_USERS WHERE USER_PREFS LIKE '%' || TITLE_ID || "%') AS USERS FROM TITLES LEFT JOIN USER_PREFS ON USER_PREFS = TITLE_ID GROUP BY TITLE_CREW.TITLE_ID)) RIGHT OUTER JOIN ((SELECT TITLE_PRINCIPALS.*,(SELECT AVG(CAST((COUNT(*)-1)/(SUM(NUM_USERS)))AS FLOAT)) AS SCORE FROM (SELECT * FROM TITLES INNER JOIN TITLE_RATINGS ON TITLE_ID=TITLE_RATINGS.TITLE_ID AND TITLES.ISADULT = TRUE WHERE (AVG(CAST(AVG(CAST(RATING*100 AS DECIMAL)+1/COUNT(RATING) )AS FLOAT)) > 7 OR ISADULT='TRUE')) GROUP BY TITLE_PRINCIPALS.TITLE_ID ORDER BY SCORE DESC LIMIT 5)) RIGHT OUTER JOIN ((SELECT TITLE_BASICS.*,ROUND((SELECT SUM(DISTINCT TITLE_CREW.USAGE)/(SELECT MAX(USAGE)*100 FROM TITLE_BASICS),0)FROM TITLE_CREW WHERE TITLE_CREW.TITLE_ID=(SELECT MIN(TITLE_ID) FROM TITLE_CREW GROUP BY TITLE_CREW.TITLE_ID))/100,'%'),0) AS PERCENTAGE FROM TITLE_BASICS INNER JOIN TITLE_NAMES ON TITLE_NAMES.TITLE_ID=TITLE_BASICS.TITLE_ID INNER JOIN TITLE_TYPE ON TITLE_TYPE.TITLE_ID=TITLE_NAMES.TITLE_ID INNER JOIN USER_PREFS ON USER_PREFS = TITLE_ID)