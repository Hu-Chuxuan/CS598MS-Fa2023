SELECT * FROM (SELECT DISTINCT tconst, avgrat AS averageRATING, COUNT(*) AS NUMVOTES FROM title_ratings WHERE avgrat BETWEEN @avrgmin AND @avrgmax ORDER BY avgrat DESC) AS T2 INNER JOIN (SELECT DISTINCT tconst, avgrat, COUNT(*), rating FROM title_ratings GROUP BY tconst, avgrat,rating HAVING COUNT(*) >= @numvotes ORDER BY count(*) desc LIMIT (@limit)) AS T1 ON T1.tconst = T2.tconst WHERE ((T1.count <= @numvotes)) OR (((T1.rating > @averageRATING))) AND ((T2.tconst NOT IN ('tt0000001')))