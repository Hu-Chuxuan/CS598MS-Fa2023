SELECT * FROM (
    SELECT DISTINCT TITLE_BASICS.*
       ,AVG(TITLE_RATINGS.AVERAGE_RATING), COUNT(*) AS NUMBEROFVOTES
        
     WHERE (((TITLE_CREW.DIRECTORS LIKE '%' || USERINPUT || '%')) AND ((TITLE_PRINCIPALS.CHARACTERS LIKE '%' || USERINPUT || '%') OR (TITLE_NAME_BASE.PRIMARY_PROFESSION = 'Director')))
       GROUP BY TITLE_BASICS.TCONST