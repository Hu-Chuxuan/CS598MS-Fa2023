SELECT movies.* FROM title_ratings movies WHERE (((movies.averageRating>=(select avg(rating) from rating where userId=?) AND (movies.averageRating<=(select max(rating) from rating where userId=?) )AND ((movies.numVotes>=1)) AND ((movies.startYear<=?) AND (movies.endYear>=?))) OR (((movies.averageRating>=(select avg(rating) from rating where userId=?) AND (movies.averageRating<=(select min(rating) from rating where userId=?) )AND ((movies.numVotes>=1)) AND ((movies.startYear<=?) AND (movies.endYear>=?)))))