SELECT * FROM ( SELECT t.*, r.*, n.*, p.* from title_basics t JOIN title_ratings r ON t.tconst = r.tconst LEFT OUTER JOIN name_basics n ON t.primaryName = n.nconst LEFT OUTER JOIN title_crew c ON t.tconst=c.tconst LEFT OUTER JOIN title_principals pr ON t.tconst=pr.tconst WHERE ((r.averageRating>3 AND NOT EXISTS (SELECT * FROM title_principals WHERE tconst=pr.tconst))) OR (r.numvotes > 20)) AS t WHERE NOT EXISTS (SELECT * FROM title_principals WHERE tconst=pr.tconst))