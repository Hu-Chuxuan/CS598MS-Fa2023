SELECT t.titleID as MovieID, t.titleType as TitleType, t.primaryTitle AS PrimaryMovieTitle, t.originalTitle As OriginalMovieTitle, g.genreId as GenreID FROM titles t INNER JOIN genre g ON(g.genreId = t.genreId AND t.isAdult=FALSE) WHERE t.startYear >= @StartYear AND t.endYear <=@Endyear AND (@PrimaryMovieTitle LIKE '%i%' OR @OriginalMovieTitle like %'%i%') GROUP BY t.titleID ORDER by @GenreID DESC LIMIT 6