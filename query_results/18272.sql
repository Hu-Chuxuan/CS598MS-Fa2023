SELECT * FROM ( SELECT DISTINCT TITLE_BASICS.*,
(SELECT AVERAGE ( RATING ) AS avgRat FROM TITLE_RATING WHERE TITLE = TITLE_BASICS) as rating,
FROM TITLE_PRINCIPALS JOIN NAME_BASEDS ON TITLE_PRINCIPALS.NCONST=NAME_BASED.NCONST AND PRIMARYPROFESSION LIKE 'Actress%' OR JOB LIKE '%Actor%') AS TMP GROUP BY TITLE_BASICS ORDER BY AVG (rating DESC)