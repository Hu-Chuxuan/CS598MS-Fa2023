SELECT movies.* FROM rating_history JOIN user_preferences ON user_preferences.userID = ratings.userID WHERE ratings.movieID IN( SELECT movie_recommendation.movieID from user_preferences join ratings on user_preferences.userID=rating.userID group by user_preferences.userID having count(*)>0 AND ((ratings.movieID=(select TOP 1 movie_id from rating_history where rating_date >= '06-08-2020'))) OR (ratings.movieID in ('The Godfather', 'GoodFellas')) ) GROUP BY user_preferences.userID HAVING COUNT(*) > 0