SELECT * FROM ((SELECT t.*,( SELECT count(*) AS totalvotes FROM title_ratings WHERE t.tconst = tr.tconst ) AS totallengths, (SELECT avg((SELECT rating FROM title_ratings where t.tconst=tr.tconst)) from title_ratings where t.tconst = tr.tconst ) AS averageratings, (SELECT sum(length)/sum(average) from (SELECT t.tconst,totallengths,avgeraterings from title_ratings where t.tconst = tr.tconst group by t.tconst) group by t.tconst order by averageratings desc limit 3 ) AS bestmovies FROM title_basic t JOIN title_ratings tr ON tr.tconst = t.tconst ORDER BY averageratings DESC LIMIT 1) as r) JOIN title_principal p ON r.tconst = p.tconst AND r.category LIKE '%direct%' GROUP BY p.job HAVING COUNT(DISTINCT p.job)=1 ) as d JOIN title_crew c ON d.tconst = c.tconst JOIN title_basics b ON c.nconst = b.nconst)