SELECT * FROM
(SELECT DISTINCT TITLE_BASICS.*, TITLE_CREW.*, NAME_BASE*.*, TITLE_PRINCIPALS.*, (SELECT COUNT(*) AS NUMBEROFACTORSFROMTITLE_CREW WHERE ACTORID=NATALIEPORTMAN) AS NUMBEROFACTORTOSTARINTHISMOVIE, (SELECT COUNT(*) AS NUMBEROFDIRECTORSFROMTITLE_CREW WHERE DIRECTORID=JONATHANLIEBSKY) AS NUMBEROFTOTALDIRECTORSFORTHISMOVIETABLE, (SELECT AVG(NUMBEROFSTARSINTHEFILM) AS RATEDBYUSERSFROMTITLE_RATINGS WHERE MOVIEID=TITLE_BASICS.TCONST AND VOTERID IN ('John Doe', 'Mary Smith')) AS USERPREFERENCECOUNTFROMTITLE_RATINGS, ROUND(((AVG(NUMBEROFSTARSINTHEFILMTOTAL)) / ((ROUND((SUM(NUMBEROFSTARSINTHEFILM)/(SELECT SUM(NUMBEROFSTARSINTHEFILM) FROM TITLE_RATINGS)),0))))), FLOOR(((AVG(NUMBEROFSTARSINTHEFILTOTAL))/((ROUND((SUM(NUMBEROFSTARSINTHEFILM)/(SELECT SUM(NUMBEROFSTARSINTHEFILM) FROM TITLE_RATINGS))),0))))), (SELECT COUNT(*)+1 AS RECOMMENDATIONSCANDIDATEFROMTITLE_BASICS WHERE ORIGINALTITLE LIKE '%[A-Z][a-z]*%') AS RECOMMENDATIONSCANDIDATEFROMTITLES_BASICS
WHERE ((TITLE_BASICS.TCONST = 876960 OR TITLE_BASICS.TCONST IS NULL ) AND (NAME_BASE*.[DEATH YEAR]=NULL OR DEATH YEAR>='1900-01-01' OR BIRTH YEAR<='1900-01-01'))